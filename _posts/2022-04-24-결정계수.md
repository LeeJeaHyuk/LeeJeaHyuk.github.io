# 최소제곱회귀



## 두 변수를 대표할 수 있는 직선

### 잔차

두 변수를 대표할 수 있는 그래프를 그리기 위해서 산점도를 찍어 보면 

![image-20220430124707203](../../images/2022-04-24-결정계수/image-20220430124707203.png)

이 점들을 근사하는 직선을 생각할 수 있는데



![image-20220430124028731](../../images/2022-04-24-결정계수/image-20220430124028731.png)

데이터들의 선형성을 대표하는 직선은 잔차를 통해 나타낸다 잔차는 해당 데이터의 y값 에서  임의의 직선 Weigint= a+b(Lenght1)의 y값을 빼서 구한다.

이 residual^2가 최소가 되게 하는 직선을 구하는 것이 최소제곱법을 통한 선형 회귀이다.

![image-20220430124028731](../../images/2022-04-24-결정계수/image-20220430124028731-16512909529331.png)

#### 잔차의 제곱을 사용하는 이유

잔차의 합을 생각해보았을 때 큰 양의 잔차와 큰 음의 잔차가 서로 더해지면 실제로는 잔차가 큰 것임에도 불구하고 잔차가 작은 의미가 되어 버릴 수 있다.

또한 잔차의 제곱을 사용하면 잔차의 절댓값이 커질수록 제곱을 더 큰 값을 가지게 되어서 잔차가 매우 큰 이상치를 발견하는 것을 더 쉽게 만든다.



### 최소제곱법을 이용한 직선 구하기

![image-20220430131311035](../../images/2022-04-24-결정계수/image-20220430131311035.png)![image-20220430131410385](../../images/2022-04-24-결정계수/image-20220430131410385.png)
$$
y_i=Weigint_i=(242,290,340..) \\
x_i=Lenght1_i=(23.2,24.0,23.9..)
$$

$$
Weigint= a+(Lenght1) \\
\\
242=a+b*23.2  \\
290=a+b*24.0  \\
340=a+b*23.9  \\
363=a+b*26.3  \\
...
$$

$$
\begin{pmatrix}
1&23.2\\1&24.0\\1&23.9\\1&26.3\\...
\end{pmatrix}

\begin{pmatrix}
a\\b
\end{pmatrix}
=
\begin{pmatrix}
242\\290\\340\\363\\...
\end{pmatrix}
$$





### 참고

알기쉬운 선형대수 개정 11판 HOWARD ANTON, CHRIS RORRES 지음







