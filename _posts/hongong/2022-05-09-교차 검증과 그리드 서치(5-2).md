# 교차 검증과 그리드 서치

## 검증 세트

![검증세트](../../images/2022-05-09-교차 검증과 그리드 서치(5-2)/검증세트.png)

테스트 세트를 사용하지 않고 훈련 세트를 더 나누어서 이를 측정하는 방법

검증 세트는 훈련 세트의 양에 따라서 20% ~30% 정도 나눈 후에 매개변수튜닝을 해준다.(?)

검증 세트로 best parameter를 찾으면 검증 세트와 훈련세트를 합친(데이터의 양이 많을 수록 좋기 때문에) 후에 최종 훈련을 한다.

이후 테스트 세트로 최종적으로 점수를 확인한다.



테스트 세트는 실제 서비스에 투입하기 전에 사용한다.

실전에서는 타깃이 없는 처음 본 데이터를 분석해야 한다 검증 세트는 이미 훈련 한 데이터가 되기 때문에 테스트 세트를 남겨놓고 훈련이 다 끝난 후에 사욯한다.

최종적으로 실전에 투입되었을 때 어느 정도의 점수를 갖는지 확인하는 용도

## 교차 검증

![교차 검증 훈련](../../images/2022-05-09-교차 검증과 그리드 서치(5-2)/교차 검증 훈련.png)

데이터가 많이 않은 경우에 검증 세트가 20%이상 차지하는게 부담일 수 있다. 이 경우에 훈련세트를 n개의 폴드로 나누어서 각 폴드마다 검증세트를 전부 해보는 것을 교차 검증이라 한다.

훈련 세트의 비율을 여러 비율로 수행하여 검증 점수를 평균내어서 가장 최적의 검증 점수를 가늠해 볼 수 있다.

훈련 세트를 3 부분으로 나누어서 교차 검증을 하면 3-폴드 교차 검증이라고 한다.

주로 5-폴드 교차 검증이나 10-폴드 교차 검증을 많이 사용한다.

교차 검증을 사용하면서 파라미터를 조금씩 바꾸어서 최적의 파라미터를 찾아 좋은 모델을 만들어내는 것이 목표

## 하이퍼파라미터 튜닝

하지만 이 하이퍼파라미터가 여러 개 있을 경우에 이것을 전부 값을 바꿔가면서 테스트하기는 어렵다.

이 하이퍼파라미터들의 최적값을 구해주는 도구가 Scikit learn의 GreedSerchCV 클래스인데 이 클래스는 교차 검증과 하이퍼파라미터 튜닝을 동시에 해준다.

