# 군집 알고리즘

### 비지도 학습

타깃을 모르는 사진을 종류별로 분류하는 것처럼 타깃이 없을 때 사용하는 머신러닝 알고리즘

특성데이터만 가지고 있을 때 사용한다.

군집과 차원축소를 사용



### 과일 데이터

[과일 데이터 링크](https://bit.ly/fruits_300_data) [캐글 원본 링크](https://www.kaggle.com/datasets/moltean/fruits)

사과 바나나 파인애플이 있는 흑백 사진

넘파이 기본 저장 포멧인 npy 파일로 저장되어 있음



# 이미지 파일 분석

이미지 파일을 살펴보면

```python
print(fruits.shape)
#(300, 100, 100)
```

100x100의 이미지가 300개가 있다는 것을 알 수 있다.



사과 이미지 한 개를 확인해보면

```python
plt.imshow(fruits[0], cmap='gray')
# 흑백이미지 이므로 gray
plt.show()
```

![image-20220516201841644](../../images/2022-05-16-비지도 학습(혼공머신6-1)/image-20220516201841644.png)



```python
#첫 번째 샘플
print(fruits[0, 0, :])
# 첫번째 샘플의 첫번째 행만
# 1개 샘플에 100 x 100이기 때문에
```

![image-20220517202544366](../../images/2022-05-16-비지도 학습(혼공머신6-1)/image-20220517202544366.png)



흑백이미지는 0~255까지 값으로 되어 있는데 255에 가까울수록 흰색 값이다.



```python
plt.imshow(fruits[0], cmap='gray_r')
# gray_r을 통해 반전할 수 있다.
plt.show()
```

![image-20220517203329653](../../images/2022-05-16-비지도 학습(혼공머신6-1)/image-20220517203329653.png)



# 픽셀 값 분석하기

각 픽셀 값을 분석하기 위해서 차원을 합쳐준다.

2차원 배열을 펼쳐서 1차원 배열로 만들어준다. 행에는 샘플이 있고 열에는 픽셀이 있게 된다.

```python
apple = fruits[0:100].reshape(-1, 100*100)
pineapple = fruits[100:200].reshape(-1, 100*100)
banana = fruits[200:300].reshape(-1, 100*100)
```



axis를 잘 지정해주어서 평균을 낸다.

axis=0으로 하면 행을 따라서 평균을 내고 axis=1으로 하면 열을 따라서 평균을 낸다.

모든 과일 샘플에 대해서 평균을 내야 하기 때문에 axis=1으로 지정해주어서 히스토그램을 그려보면

```python
plt.hist(np.mean(apple, axis=1), alpha=0.8)
plt.hist(np.mean(pineapple, axis=1), alpha=0.8)
plt.hist(np.mean(banana, axis=1), alpha=0.8)
plt.legend(['apple', 'pineapple', 'banana'])
plt.show()
```

![image-20220517204837006](../../images/2022-05-16-비지도 학습(혼공머신6-1)/image-20220517204837006.png)

과일 중에서 바나나는 평균값이 20~60에 대부분이 분포해있어서 쉽게 구분할 수 있지만 파인애플과 사과를 구분하는 것은 쉽지 않을 것처럼 보인다.



샘플별 평균값이 아닌 픽셀 별 평균값을 구해 보면

```python
fig, axs = plt.subplots(1, 3, figsize=(20, 5))
axs[0].bar(range(10000), np.mean(apple, axis=0))
axs[1].bar(range(10000), np.mean(pineapple, axis=0))
axs[2].bar(range(10000), np.mean(banana, axis=0))
plt.show()
```

![image-20220518203720648](../../images/2022-05-16-비지도 학습(혼공머신6-1)/image-20220518203720648.png)